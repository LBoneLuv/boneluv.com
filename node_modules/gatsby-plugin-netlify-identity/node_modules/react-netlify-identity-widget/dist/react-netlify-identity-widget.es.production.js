import e from"react";import{Dialog as t}from"@reach/dialog";import n from"@reach/visually-hidden";import{useIdentityContext as r,IdentityContextProvider as a}from"react-netlify-identity";export{useNetlifyIdentity}from"react-netlify-identity";import{Tabs as l,TabList as o,Tab as s,TabPanels as i,TabPanel as c}from"@reach/tabs";function m(){const[t,n]=e.useState(!1),r=e.useRef(!1);return e.useEffect(()=>(r.current=!0,()=>void(r.current=!1)),[]),[t,function(e){return n(!0),e.finally(()=>r.current&&n(!1))}]}function u(){const{loginUser:t}=r(),a=e.useRef(null),[l,o]=e.useState(""),[s,i]=m();return e.createElement("form",{ref:a,className:"form",onSubmit:e=>{e.preventDefault();const n=e.target,r=n.email.value,a=n.password.value;i(t(r,a,!0)).then(e=>{console.log("Success! Logged in",e)}).catch(e=>void console.error(e)||o("Error: "+e.message))}},e.createElement("div",{className:"formGroup",key:"email"},e.createElement("label",null,e.createElement(n,null,"Enter your email"),e.createElement("input",{className:"formControl",type:"email",name:"email",placeholder:"Email",autoCapitalize:"off",required:!0}),e.createElement("div",{className:"inputFieldIcon inputFieldEmail"}))),e.createElement("div",{className:"formGroup",key:"password"},e.createElement("label",null,e.createElement(n,null,"Enter your password"),e.createElement("input",{className:"formControl",type:"password",name:"password",placeholder:"Password",required:!0}),e.createElement("div",{className:"inputFieldIcon inputFieldPassword"}))),e.createElement("div",null,e.createElement("button",{type:"submit",className:s?"btn saving":"btn"},"Log in"),l&&e.createElement("pre",{style:{background:"salmon",padding:10}},l)),e.createElement("button",{type:"button",className:"btnLink forgotPasswordLink"},"Forgot password?"))}function d(){const t=r(),n=t&&t.user&&t.user.user_metadata&&t.user.user_metadata.full_name||"NoName",[a,l]=m();return e.createElement(e.Fragment,null,e.createElement("div",{className:"header"},e.createElement("button",{className:"btn btnHeader active"},"Logged in")),e.createElement("form",{className:"form "},e.createElement("p",{className:"infoText"},"Logged in as ",e.createElement("br",null),e.createElement("span",{className:"infoTextEmail"},n)),e.createElement("button",{type:"submit",className:a?"btn saving":"btn",onClick:()=>l(t.logoutUser())},"Log out")))}function p(){const{signupUser:t}=r(),a=e.useRef(null),[l,o]=e.useState(""),[s,i]=m();return e.createElement("form",{ref:a,className:"form",onSubmit:e=>{e.preventDefault(),(()=>{if(!a.current)return;const e=a.current.username.value,n=a.current.email.value,r=a.current.password.value,l={signupSource:"react-netlify-identity-widget",full_name:e};i(t(n,r,l)).then(e=>{console.log("Success! Signed up",e)}).catch(e=>void console.error(e)||o("Error: "+e.message))})()}},e.createElement("div",{className:"formGroup",key:"username"},e.createElement("label",null,e.createElement(n,null,"Enter your name"),e.createElement("input",{id:"username",className:"formControl",type:"name",name:"username",placeholder:"Name",autoCapitalize:"off",required:!0}),e.createElement("div",{className:"inputFieldIcon inputFieldName"}))),e.createElement("div",{className:"formGroup",key:"email"},e.createElement("label",null,e.createElement(n,null,"Enter your email"),e.createElement("input",{className:"formControl",type:"email",name:"email",placeholder:"Email",autoCapitalize:"off",required:!0}),e.createElement("div",{className:"inputFieldIcon inputFieldEmail"}))),e.createElement("div",{className:"formGroup",key:"password"},e.createElement("label",null,e.createElement(n,null,"Enter your password"),e.createElement("input",{className:"formControl",type:"password",name:"password",placeholder:"Password",required:!0}),e.createElement("div",{className:"inputFieldIcon inputFieldPassword"}))),e.createElement("div",null,e.createElement("button",{type:"submit",className:s?"btn saving":"btn"},"Sign Up"),l&&e.createElement("pre",{style:{background:"salmon",padding:10}},l)))}function E(){const{settings:t}=r(),n=Object.entries(t.external).some(([e,t])=>["github","gitlab","bitbucket","google"].includes(e)&&t);if(!n)return null;let a=!1;return"undefined"!=typeof window&&(a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))),e.createElement("div",{className:"providersGroup"},a&&e.createElement("pre",null,"⚠️Testing providers on localhost won't work because OAuth redirects to your production site"),e.createElement("hr",{className:"hr"}),e.createElement(f,{settings:t,provider:"Google"}),e.createElement(f,{settings:t,provider:"GitHub"}),e.createElement(f,{settings:t,provider:"GitLab"}),e.createElement(f,{settings:t,provider:"Bitbucket"}))}function f({settings:t,provider:n}){const a=t.external;if(!a[n.toLowerCase()])return null;const{loginProvider:l}=r();return e.createElement("button",{onClick:()=>l(n.toLowerCase()),className:`provider${n} btn btnProvider`},"Continue with ",n)}function g(){return e.createElement("div",null,e.createElement(l,{defaultIndex:0},e.createElement(o,{className:"header"},e.createElement(s,{className:"btn btnHeader"},"Login"),e.createElement(s,{className:"btn btnHeader"},"Sign Up")),e.createElement(i,null,e.createElement(c,null,e.createElement(u,null)),e.createElement(c,null,e.createElement(p,null)))),e.createElement(E,null))}function b(){return e.createElement(d,null)}function v({}){const t=r(),n=Boolean(t&&t.user);return e.createElement(n?b:g,null)}function h({onCloseDialog:t}){return e.createElement(v,{onCloseDialog:t})}class N extends e.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?e.createElement("h1",null,"Something went loading the widget."):this.props.children}}const y=a,w=r;function C({showDialog:r,onCloseDialog:a}){return e.createElement(t,{isOpen:r,onDismiss:a,style:{border:"solid 5px hsla(0, 0%, 0%, 0.5)",borderRadius:"10px",position:"relative",maxWidth:400}},e.createElement("button",{className:"btn btnClose",onClick:a},e.createElement(n,null,"Close")),e.createElement(N,null,e.createElement(e.Suspense,{fallback:e.createElement("div",null,"Loading...")},e.createElement(h,{onCloseDialog:a}))))}export default C;export{y as IdentityContextProvider,C as IdentityModal,w as useIdentityContext};
//# sourceMappingURL=react-netlify-identity-widget.es.production.js.map
